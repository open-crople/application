{% extends "index.html" %}
{% block section %}
<link rel="stylesheet" href="../../static/reg_reviews_style.css">
<style>
#myform fieldset{
    display: inline-block;
    direction: rtl;
    border: 0;
}

#myform fieldset lengend{
    text-align: right;
}

#myform input[type=radio]{
    display: none;
}

.rate-label {
    font-size: 2.5em;
    color: #D3D3D3; /* Light gray color for default */
    text-shadow: 0 0 0 #f0f0f0;
    transition: color 0.3s; /* Smooth transition for color change */
}


.rate-label:hover {
    color: rgba(250, 208, 0, 0.99); /* Yellow color on hover */
}

.rate-label:hover ~ .rate-label {
    color: rgba(250, 208, 0, 0.99); /* Yellow color on hover for adjacent stars */
}

#myform input[type=radio]:checked ~ .rate-label{
    text-shadow: 0 0 0 rgba(250, 208, 0, 0.99);
}

#submitReview {
    background-color: #00462A; 
    color: #FFFFFF;
    margin: 7%;
    padding: 10px;
    font-size: 16px;
    border: none;
    cursor: pointer;
    border-radius: 4px;
    width: 20%;
        
}
    

#reviewContents {
width: 100%;
height: 150px;
padding: 10px;
box-sizing: border-box; border: solid 1.5px #D3D3D3; border-radius: 5px;
font-size: 16px;
resize: none; }

.container {
            min-height: calc(100vh - 30px);
            flex-grow: 1;
            overflow-y: auto;
        }
    
.review-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10%;
            margin-right: 10%;
            width: 80%;  
        }

      
.image-container {
            flex: 0.2;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 5%;
            width: 200px;
            height: 200px;
            border: 2px solid #D9D9D9;
            border-radius: 4px;
            border-collapse: collapse;
        }
        
 .image-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

 .text-container {
            flex: 0.8;
            text-align: justify;
            font-size: 24px;
            font-weight: bold;
        }
 
.star-rating .star img {
    width: 7%;
    height: 7%;
    object-fit: contain;
    padding: 0.5%;
    margin-top: 2%;
    filter: brightness(0%);
}

.star-rating .star img:hover,
.star-rating .star.active img {
    filter: brightness(0%);
}

.review-table {
          width: 80%;
          margin: 0 auto;
          margin-top: 2%;
          border-collapse: collapse;
        }

.review-table th, .review-table td {
          text-align: left;
          padding: 20px;
          border-bottom: 1px solid #D9D9D9;
        }

.review-table th {
          font-size: 20px;
          vertical-align: top;
        }

.review-table input[type="text"],
.review-table textarea {
          width: calc(100% - 12px);
          height: 40px;
          border-radius: 3px;
          border: 1px solid #D9D9D9;
          padding: 5px;
          box-sizing: border-box;
        }

.review-table textarea {
          height: 80px;
          resize: none;
        }

</style>
<form class="mb-3" name="myform" id="myform" method="post" action="/reg_reviews" enctype="multipart/form-data">
   
<div class="container">
    <div class="review-container">
        
        <div class="image-container">
            <img src="{{ url_for('static', filename='images/' + data.img_path) }}" alt="pic">
        </div>
        <div class="text-container">
            
            <p>{{name}}</p><br>
            
<fieldset>
    <input type="radio" name="reviewStar" value="5" id="rate1" /><label for="rate1" class="rate-label">★</label>
    <input type="radio" name="reviewStar" value="4" id="rate2" /><label for="rate2" class="rate-label">★</label>
    <input type="radio" name="reviewStar" value="3" id="rate3" /><label for="rate3" class="rate-label">★</label>
    <input type="radio" name="reviewStar" value="2" id="rate4" /><label for="rate4" class="rate-label">★</label>
    <input type="radio" name="reviewStar" value="1" id="rate5" /><label for="rate5" class="rate-label">★</label>
</fieldset>

        </div>
    </div>
        
    
        <table class="review-table">
      <tr>
        <th><label class="review-title" for="reviewTitle">리뷰 제목</label></th>
        <td><input type="text" name="reviewTitle" id="reviewTitle" placeholder="리뷰 제목을 입력해주세요" required /></td>
      </tr>
      <tr>
        <th><label class="review-title" for="reviewText">리뷰 작성</label></th>
        <td><textarea id="reviewText" name="reviewText" rows="4" cols="80" placeholder="리뷰를 작성해주세요"></textarea></td>
      </tr>
    <tr>
      <th><label class="review-title" for="reviewImage">상품 이미지</label></th>
      <td><input type="file" name="reviewImage" id="reviewImage" accept="image/*" /></td>
     </tr>
        </table>
        <input id="name" name="name" style="visibility: visible; opacity: 0;" value="{{name}}" />
        <input id="seller" name="seller" style="visibility: visible; opacity: 0;" value="{{data.seller}}" />
        <input id="img_path" name="img_path" style="visibility: visible; opacity: 0;" value="{{data.img_path}}" />
        {% if session['id'] %}
        <input id="writer" name="writer" style="visibility: visible; opacity: 0;" value="{{session['id']}}" />
        {% endif %}
    

<div class="buttons-container">
      <!--<button type="button1" id="submitReview" >거래 리뷰 작성하기</button>-->
    <input type="submit" id="submitReview" value="거래 리뷰 작성하기"/>
    <button type="button" id="cancelReview"><a href="/mypage" style=" color: white; text-decoration: none;">취소하기</a></button>
</div>
</div>   
</form>
   

<script>
    var cancelButton = document.getElementById("cancelReview");

    cancelButton.addEventListener("click", function() {

        var confirmation = confirm("리뷰 작성을 취소하시겠습니까?");

        if (confirmation) {
            history.back();
        }
    });
    
    var submitButton = document.getElementById("submitReview");

    submitButton.addEventListener("click", function() {
        // 리뷰가 입력되었으니 해당 상품의 이름을 localStorage에 저장합니다.
        var itemName = "{{ name }}"; // 상품 이름을 설정합니다.
        localStorage.setItem('reviewSubmittedForItem', itemName);
        alert("리뷰가 입력되었습니다.");

        // 리뷰 작성 시 해당 버튼을 비활성화합니다.
        disableButton(itemName);
    });
    
    function disableButton(item) {
        var reviewButton = document.getElementById("review_" + item);
        if (reviewButton && !reviewButton.disabled) { // 이미 비활성화된 버튼인지 확인
            reviewButton.disabled = true;
            reviewButton.style.backgroundColor = '#CCCCCC';
            reviewButton.style.cursor = 'not-allowed';
            // 이미 비활성화된 버튼에 대해서만 추가적인 비활성화가 실행되지 않도록 합니다.
            localStorage.setItem('disabledReviewButton_' + item, 'disabled');
        }
    }
    
    window.onload = function() {
        var reviewSubmittedForItem = localStorage.getItem('reviewSubmittedForItem');
        var disabledButton = document.getElementById("review_" + reviewSubmittedForItem);

        // 저장된 상품 리뷰가 있을 경우 해당 상품 버튼을 비활성화합니다.
        if (reviewSubmittedForItem) {
            disableButton(reviewSubmittedForItem);
        }
    };
</script>


    
{% endblock section %}
